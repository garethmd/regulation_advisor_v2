"use client"; // This makes the component interactive (Client Component)

import { useState } from "react";
import { remark } from 'remark';
import html from 'remark-html';


export default function Home() {
  const [question, setQuestion] = useState(""); // State for input field
  const [loading, setLoading] = useState(false);
  const [response, setResponse] = useState("");

  const handleSubmit = async () => {
    if (!question.trim()) {
      setResponse("Please enter a question.");
      return;
    }
    const useMock = false;
    setLoading(true);

    if (useMock){
        await new Promise((resolve) => setTimeout(resolve, 500));

        // Mock API response
        //const mockData = {
        //    raw: "**This is a mock response!**\n\n- List item 1\n- List item 2\n\n[Click me](https://example.com)"
        //};
        const mockData = {
            "success": true,
            "message": "{\n  \"raw\": \"# Implications and Recommendations for UK Software Businesses concerning Californian AI Legislation\\n\\n## 1. California S 892 Public Contracts: Automated Decision Tools  \\n**Implications**:  \\nUK software companies providing AI solutions must ensure their products adhere to the standardized regulations issued by the California Department of Technology for automated decision systems (ADS). This could lead to a need for significant documentation and audit trails to demonstrate compliance when dealing with California government contracts. Failure to comply may result in disqualification from bidding on public contracts.\\n\\n**Recommendation**:  \\nEstablish a compliance team focusing on regulatory standards and perform a gap analysis of current offerings against the expected ADS standards to ensure readiness. Consider investing in compliance management software to streamline the documentation process and stay updated on regulatory changes.\\n\\n## 2. California S 893 California Artificial Intelligence Research Hub  \\n**Implications**:  \\nOpportunities for collaborative research, funding, and knowledge-sharing open up for UK businesses in the AI space. This allows for potential partnerships that can enhance technological capabilities and innovation, especially in emerging areas of AI research, aligning UK firms with leading-edge initiatives.\\n\\n**Recommendation**:  \\nEngage with local partners to explore participation in the research hub. Network at conferences and industry events to identify potential collaborators and consider applying for grants or funding opportunities that may provide financial incentives for collaboration in AI research.\\n\\n## 3. California S 896 Generative Artificial Intelligence Accountability Act  \\n**Implications**:  \\nUK companies targeting the Californian market may need to incorporate risk management processes related to their generative AI applications, affecting how products are developed and marketed. The requirement for accountability could also necessitate the hiring of additional compliance personnel.\\n\\n**Recommendation**:  \\nImplement comprehensive risk assessment protocols and ensure product teams are trained to identify and mitigate potential security risks in AI products. Develop a risk management framework that integrates compliance at all stages of product development and stay ahead of anticipated regulatory requirements.\\n\\n## 4. California S 942 California AI Transparency Act  \\n**Implications**:  \\nThis act's requirements for AI detection tools and content disclosure may result in higher operational costs as companies need to integrate compliance technologies into their products. Ensuring compliance could impact product timelines and profitability.\\n\\n**Recommendation**:  \\nBudget for the development and integration of transparency features in AI tools and consider developing a customer communication strategy to explain these features to end-users. Transparency can become a selling point in marketing efforts, showcasing a commitment to ethical practices.\\n\\n## 5. California S 1047 Safe and Secure Innovation for Frontier Artificial Intelligence Models Act  \\n**Implications**:  \\nRobust security protocols must be implemented for companies developing advanced AI models, with significant implications for product development timelines and costs. Non-compliance could lead to market exclusion.\\n\\n**Recommendation**:  \\nPrioritize security in the development phase and invest in testing and validation processes to meet the new compliance standards. Conduct regular audits and simulations to assess security measures and ensure they can withstand potential threats.\\n\\n## 6. California S 1220 Public Benefits Contracts: Phone Operator Jobs  \\n**Implications**:  \\nThis restrictiveness concerning the use of AI in public sector jobs may impact any UK entity involved in government work, forcing them to rethink solutions or be excluded from projects. This could limit certain market opportunities previously available.\\n\\n**Recommendation**:  \\nEvaluate current offerings for public sector contracts and consider diversifying AI applications to meet compliance with these restrictions. Consult with legal advisors on contract obligations and adapt business strategies as necessary.\\n\\n## 7. California A 3050 Artificial Intelligence  \\n**Implications**:  \\nThe establishment of watermark standards for AI-generated content may require substantial re-engineering of existing technologies, potentially leading to increased costs and delays in product launches.\\n\\n**Recommendation**:  \\nMonitor developments closely and prepare to invest in technological modifications or enhancements to align with watermarking standards. Set up a cross-functional team to oversee adaptation efforts and new product features that comply with these standards.\\n\\n## 8. California A 3058 California Unconditional Benefit Program  \\n**Implications**:  \\nIncreased scrutiny on job displacement due to AI will likely affect corporate policies regarding employee impacts, social responsibility, and transparency in operations. UK companies may face backlash if not addressing these concerns proactively.\\n\\n**Recommendation**:  \\nDevelop and enhance corporate social responsibility (CSR) strategies that address AI impact on employment, ensuring alignment with ethical standards and community needs. Consider programs that reskill employees and provide a clear narrative on how AI will benefit rather than displace jobs.\\n\\n## 9. California ACR 96 23 Asilomar AI Principles  \\n**Implications**:  \\nUK firms will need to align their AI practices with these guiding ethical principles, promoting a commitment to responsible AI development to remain competitive in the marketplace.\\n\\n**Recommendation**:  \\nReview internal policies on ethical AI development to ensure adherence to these principles. Formulate a communication strategy to highlight ethical practices to clients and stakeholders, as well as integrating these principles into marketing efforts.\\n\\n## 10. California AJR 6 Artificial Intelligence  \\n**Implications**:  \\nPotential moratoriums on advancing AI systems could result in unexpected operational challenges for UK developers, necessitating flexibility in their innovation strategies. This regulatory uncertainty could also dissuade investment in AI projects targeted at the California market.\\n\\n**Recommendation**:  \\nAdopt agile project methodologies that allow for rapid shifts in development priorities based on forthcoming regulatory changes in California. Establish a regulatory watch team to keep abreast of legislative updates and adjust strategy accordingly.\\n\\n**Overall Summary**:  \\nThe regulatory landscape shaped by Californian AI legislation presents both challenges and opportunities for UK software businesses. Compliance may come at a cost, prompting organizations to invest in new technologies and processes while navigating complexities. However, the potential for collaboration within innovative research hubs and the commitment to ethical AI practices could pave the way for strategic advantages in the competitive landscape. It is imperative for UK software businesses to proactively adapt to these changes while leveraging them for growth opportunities. Actions to consider include strengthening compliance frameworks, increasing transparency in AI deployments, closely monitoring legislative developments, and enhancing partnerships within the evolving AI ecosystem.\",\n  \"pydantic\": null,\n  \"json_dict\": null,\n  \"tasks_output\": [\n    {\n      \"description\": \"Conduct a thorough research about AI Legislation and its relevance to what are the implications of Californian legislation on UK software businesses?. Make sure you find any interesting and relevant information, taking into  account the jurisdiction of the AI Legislation.\\n\",\n      \"name\": \"research_task\",\n      \"expected_output\": \"A summary of each relevant AI Legislation bill necessary to answer what are the implications of Californian legislation on UK software businesses?\\n\",\n      \"summary\": \"Conduct a thorough research about AI Legislation and its relevance...\",\n      \"raw\": \"To understand the implications of Californian AI legislation on UK software businesses, we need to analyze various bills that reflect significant developments in AI regulation. Here is a summary of the relevant proposed and enacted legislature:\\n\\n1. **California S 892 Public Contracts: Automated Decision Tools**: This bill mandates that the Department of Technology in California develop standardized regulations for automated decision systems (ADS). For UK software businesses that offer AI tools, they might need to ensure compliance with these standards if they engage in contracts with California's government entities.\\n\\n2. **California S 893 California Artificial Intelligence Research Hub**: A collaborative hub for government agencies, academia, and private sectors will be created to advance AI research. UK firms can potentially participate in this hub, opening avenues for partnerships, research funding, and technology sharing.\\n\\n3. **California S 896 Generative Artificial Intelligence Accountability Act**: This requires risk analyses of generative AI's threats to critical infrastructure. UK companies marketing generic AI solutions may find that they need to account for similar accountability measures under Californian law, thus influencing their product designs for the Californian market.\\n\\n4. **California S 942 California AI Transparency Act**: This act compels providers to make an AI detection tool available and requires disclosure in AI-generated content. UK firms delivering AI services in or to California will need to develop systems that comply with these transparency standards, perhaps increasing operational costs and affecting competitive positioning.\\n\\n5. **California S 1047 Safe and Secure Innovation for Frontier Artificial Intelligence Models Act**: Companies developing advanced AI models must follow strict security protocols. UK developers should consider this when developing similar products, as failure to comply with Californian regulations can prohibit access to the marketplace.\\n\\n6. **California S 1220 Public Benefits Contracts: Phone Operator Jobs**: This bill restricts the use of AI in public service jobs, potentially influencing UK firms involved in public sector projects requiring similar constraints on AI use, and thus requiring businesses to adapt their AI solutions to remain compliant.\\n\\n7. **California A 3050 Artificial Intelligence**: The bill establishes watermark standards for AI-generated content. UK software businesses could face challenges in re-engineering existing technologies to meet new standards.\\n\\n8. **California A 3058 California Unconditional Benefit Program**: This program indicates that AI-related job displacement is a concern, aligning with a global trend. UK companies may see increased scrutiny over the impact of AI on employment, which influences corporate responsibility policies.\\n\\n9. **California ACR 96 23 Asilomar AI Principles**: Supporting these principles signifies a move towards ethical AI. UK businesses may need to align their practices with these ethical considerations as they engage with Californian markets.\\n\\n10. **California AJR 6 Artificial Intelligence**: This resolution urges a moratorium on certain AI training advancements. UK software developers may find both challenges and opportunities in adjusting their techniques to align with such regulatory considerations in California.\\n\\n**Implications for UK Software Businesses**: \\n\\n- Compliance Costs: Adapting to Californian laws may require significant investment into compliance structures and technology adjustments.\\n- Market Access: Understanding and adhering to these regulations is crucial for UK firms aiming for market access in California.\\n- Ethical Standards: UK businesses may need to elevate their ethical considerations in AI deployment to remain competitive.\\n- Collaborative Opportunities: Increased collaboration prospects may arise from Californian initiatives that focus on AI development.\\n\\nOverall, this regulatory environment encourages UK software businesses to be proactive in their strategies, ensuring they meet the evolving landscape of AI legislation while capitalizing on potential opportunities for collaboration and compliance.\",\n      \"pydantic\": null,\n      \"json_dict\": null,\n      \"agent\": \"AI Legislation Senior Legal Researcher\\n\",\n      \"output_format\": \"raw\"\n    },\n    {\n      \"description\": \"Complete an assessment of AI Legislation and its relevance to what are the implications of Californian legislation on UK software businesses? from the context you got, assess the implications of each topic and write a summarise the  implications of each topic and recommend actions to consider.\\n\",\n      \"name\": \"regulatory_compliance_task\",\n      \"expected_output\": \"A commentary of implications and recommendations for each topic\\n\",\n      \"summary\": \"Complete an assessment of AI Legislation and its relevance to...\",\n      \"raw\": \"**Implications and Recommendations for UK Software Businesses concerning Californian AI Legislation**\\n\\n1. **California S 892 Public Contracts: Automated Decision Tools**  \\n   **Implications**: UK software companies providing AI solutions must ensure their products adhere to the standardized regulations issued by the California Department of Technology for automated decision systems (ADS). This could lead to a need for significant documentation and audit trails to demonstrate compliance when dealing with California government contracts.  \\n   **Recommendation**: Establish a compliance team focusing on regulatory standards and perform a gap analysis of current offerings against the expected ADS standards to ensure readiness.\\n\\n2. **California S 893 California Artificial Intelligence Research Hub**  \\n   **Implications**: Opportunities for collaborative research, funding, and knowledge-sharing open up for UK businesses in the AI space. This allows for potential partnerships that can enhance technological capabilities and innovation.  \\n   **Recommendation**: Engage with local partners to explore participation in the research hub. Consider grants or funding opportunities that may provide financial incentives for collaboration in AI research.\\n\\n3. **California S 896 Generative Artificial Intelligence Accountability Act**  \\n   **Implications**: UK companies targeting the Californian market may need to incorporate risk management processes related to their generative AI applications, affecting how products are developed and marketed.  \\n   **Recommendation**: Implement comprehensive risk assessment protocols and ensure product teams are trained to identify and mitigate potential security risks in AI products.\\n\\n4. **California S 942 California AI Transparency Act**  \\n   **Implications**: This act's requirements for AI detection tools and content disclosure may result in higher operational costs as companies need to integrate compliance technologies into their products.  \\n   **Recommendation**: Budget for the development and integration of transparency features in AI tools and consider developing a customer communication strategy to explain these features to end-users.\\n\\n5. **California S 1047 Safe and Secure Innovation for Frontier Artificial Intelligence Models Act**  \\n   **Implications**: Robust security protocols must be implemented for companies developing advanced AI models, with significant implications for product development timelines and costs.  \\n   **Recommendation**: Prioritize security in the development phase and invest in testing and validation processes to meet the new compliance standards.\\n\\n6. **California S 1220 Public Benefits Contracts: Phone Operator Jobs**  \\n   **Implications**: This restrictiveness about using AI in public sector jobs may impact any UK entity involved in government work, forcing them to rethink solutions or be excluded from projects.  \\n   **Recommendation**: Evaluate current offerings for public sector contracts and consider diversifying AI applications to meet compliance with these restrictions.\\n\\n7. **California A 3050 Artificial Intelligence**  \\n   **Implications**: The establishment of watermark standards for AI-generated content may require substantial re-engineering of existing technologies.  \\n   **Recommendation**: Monitor developments closely and prepare to invest in technological modifications or enhancements to align with watermarking standards.\\n\\n8. **California A 3058 California Unconditional Benefit Program**  \\n   **Implications**: Increased scrutiny on job displacement due to AI will likely affect corporate policies regarding employee impacts, social responsibility, and transparency in operations.  \\n   **Recommendation**: Develop and enhance corporate social responsibility (CSR) strategies that address AI impact on employment, ensuring alignment with ethical standards and community needs.\\n\\n9. **California ACR 96 23 Asilomar AI Principles**  \\n   **Implications**: UK firms will need to align their AI practices with these guiding ethical principles, promoting a commitment to responsible AI development in order to compete effectively.  \\n   **Recommendation**: Review internal policies on ethical AI development to ensure adherence to these principles. Formulate a communication strategy to highlight ethical practices to clients and stakeholders.\\n\\n10. **California AJR 6 Artificial Intelligence**  \\n    **Implications**: Potential moratoriums on advancing AI systems could result in unexpected operational challenges for UK developers, necessitating flexibility in their innovation strategies.  \\n    **Recommendation**: Adopt agile project methodologies that allow rapid shifts in development priorities based on forthcoming regulatory changes in California.\\n\\n**Overall Summary**:  \\nThe regulatory landscape shaped by Californian AI legislation presents both challenges and opportunities for UK software businesses. Compliance may come at a cost, prompting organizations to invest in new technologies and processes. However, the potential for collaboration within innovative research hubs and the commitment to ethical AI practices could pave the way for strategic advantages in the competitive landscape. It is imperative for UK software businesses to proactively adapt to these changes while leveraging them for growth opportunities. Actions to consider include strengthening compliance frameworks, increasing transparency in AI deployments, closely monitoring legislative developments, and enhancing partnerships within the evolving AI ecosystem.\",\n      \"pydantic\": null,\n      \"json_dict\": null,\n      \"agent\": \"AI Legislation Regulatory Compliance Analyst\\n\",\n      \"output_format\": \"raw\"\n    },\n    {\n      \"description\": \"Review the context you got and expand each topic into a full section for a report. Make sure the report is detailed and contains any and all relevant information.\\n\",\n      \"name\": \"reporting_task\",\n      \"expected_output\": \"A fully fledged report with the main topics, each with a full section of information. Formatted as markdown without '```'\\n\",\n      \"summary\": \"Review the context you got and expand each topic into...\",\n      \"raw\": \"# Implications and Recommendations for UK Software Businesses concerning Californian AI Legislation\\n\\n## 1. California S 892 Public Contracts: Automated Decision Tools  \\n**Implications**:  \\nUK software companies providing AI solutions must ensure their products adhere to the standardized regulations issued by the California Department of Technology for automated decision systems (ADS). This could lead to a need for significant documentation and audit trails to demonstrate compliance when dealing with California government contracts. Failure to comply may result in disqualification from bidding on public contracts.\\n\\n**Recommendation**:  \\nEstablish a compliance team focusing on regulatory standards and perform a gap analysis of current offerings against the expected ADS standards to ensure readiness. Consider investing in compliance management software to streamline the documentation process and stay updated on regulatory changes.\\n\\n## 2. California S 893 California Artificial Intelligence Research Hub  \\n**Implications**:  \\nOpportunities for collaborative research, funding, and knowledge-sharing open up for UK businesses in the AI space. This allows for potential partnerships that can enhance technological capabilities and innovation, especially in emerging areas of AI research, aligning UK firms with leading-edge initiatives.\\n\\n**Recommendation**:  \\nEngage with local partners to explore participation in the research hub. Network at conferences and industry events to identify potential collaborators and consider applying for grants or funding opportunities that may provide financial incentives for collaboration in AI research.\\n\\n## 3. California S 896 Generative Artificial Intelligence Accountability Act  \\n**Implications**:  \\nUK companies targeting the Californian market may need to incorporate risk management processes related to their generative AI applications, affecting how products are developed and marketed. The requirement for accountability could also necessitate the hiring of additional compliance personnel.\\n\\n**Recommendation**:  \\nImplement comprehensive risk assessment protocols and ensure product teams are trained to identify and mitigate potential security risks in AI products. Develop a risk management framework that integrates compliance at all stages of product development and stay ahead of anticipated regulatory requirements.\\n\\n## 4. California S 942 California AI Transparency Act  \\n**Implications**:  \\nThis act's requirements for AI detection tools and content disclosure may result in higher operational costs as companies need to integrate compliance technologies into their products. Ensuring compliance could impact product timelines and profitability.\\n\\n**Recommendation**:  \\nBudget for the development and integration of transparency features in AI tools and consider developing a customer communication strategy to explain these features to end-users. Transparency can become a selling point in marketing efforts, showcasing a commitment to ethical practices.\\n\\n## 5. California S 1047 Safe and Secure Innovation for Frontier Artificial Intelligence Models Act  \\n**Implications**:  \\nRobust security protocols must be implemented for companies developing advanced AI models, with significant implications for product development timelines and costs. Non-compliance could lead to market exclusion.\\n\\n**Recommendation**:  \\nPrioritize security in the development phase and invest in testing and validation processes to meet the new compliance standards. Conduct regular audits and simulations to assess security measures and ensure they can withstand potential threats.\\n\\n## 6. California S 1220 Public Benefits Contracts: Phone Operator Jobs  \\n**Implications**:  \\nThis restrictiveness concerning the use of AI in public sector jobs may impact any UK entity involved in government work, forcing them to rethink solutions or be excluded from projects. This could limit certain market opportunities previously available.\\n\\n**Recommendation**:  \\nEvaluate current offerings for public sector contracts and consider diversifying AI applications to meet compliance with these restrictions. Consult with legal advisors on contract obligations and adapt business strategies as necessary.\\n\\n## 7. California A 3050 Artificial Intelligence  \\n**Implications**:  \\nThe establishment of watermark standards for AI-generated content may require substantial re-engineering of existing technologies, potentially leading to increased costs and delays in product launches.\\n\\n**Recommendation**:  \\nMonitor developments closely and prepare to invest in technological modifications or enhancements to align with watermarking standards. Set up a cross-functional team to oversee adaptation efforts and new product features that comply with these standards.\\n\\n## 8. California A 3058 California Unconditional Benefit Program  \\n**Implications**:  \\nIncreased scrutiny on job displacement due to AI will likely affect corporate policies regarding employee impacts, social responsibility, and transparency in operations. UK companies may face backlash if not addressing these concerns proactively.\\n\\n**Recommendation**:  \\nDevelop and enhance corporate social responsibility (CSR) strategies that address AI impact on employment, ensuring alignment with ethical standards and community needs. Consider programs that reskill employees and provide a clear narrative on how AI will benefit rather than displace jobs.\\n\\n## 9. California ACR 96 23 Asilomar AI Principles  \\n**Implications**:  \\nUK firms will need to align their AI practices with these guiding ethical principles, promoting a commitment to responsible AI development to remain competitive in the marketplace.\\n\\n**Recommendation**:  \\nReview internal policies on ethical AI development to ensure adherence to these principles. Formulate a communication strategy to highlight ethical practices to clients and stakeholders, as well as integrating these principles into marketing efforts.\\n\\n## 10. California AJR 6 Artificial Intelligence  \\n**Implications**:  \\nPotential moratoriums on advancing AI systems could result in unexpected operational challenges for UK developers, necessitating flexibility in their innovation strategies. This regulatory uncertainty could also dissuade investment in AI projects targeted at the California market.\\n\\n**Recommendation**:  \\nAdopt agile project methodologies that allow for rapid shifts in development priorities based on forthcoming regulatory changes in California. Establish a regulatory watch team to keep abreast of legislative updates and adjust strategy accordingly.\\n\\n**Overall Summary**:  \\nThe regulatory landscape shaped by Californian AI legislation presents both challenges and opportunities for UK software businesses. Compliance may come at a cost, prompting organizations to invest in new technologies and processes while navigating complexities. However, the potential for collaboration within innovative research hubs and the commitment to ethical AI practices could pave the way for strategic advantages in the competitive landscape. It is imperative for UK software businesses to proactively adapt to these changes while leveraging them for growth opportunities. Actions to consider include strengthening compliance frameworks, increasing transparency in AI deployments, closely monitoring legislative developments, and enhancing partnerships within the evolving AI ecosystem.\",\n      \"pydantic\": null,\n      \"json_dict\": null,\n      \"agent\": \"{topic} Regulatory Compliance Analyst\\n\",\n      \"output_format\": \"raw\"\n    }\n  ],\n  \"token_usage\": {\n    \"total_tokens\": 7173,\n    \"prompt_tokens\": 5502,\n    \"cached_prompt_tokens\": 0,\n    \"completion_tokens\": 1671,\n    \"successful_requests\": 2\n  }\n}"
        };
        const message = JSON.parse(mockData.message);
        const raw = message.raw;
        console.log(raw);

        const processedContent = await remark()
          .use(html)
          .process(raw);
        const contentHtml = processedContent.toString();

        setResponse(contentHtml);
    }
    else{
        try {
        const res = await fetch("/api/query", {
            method: "POST",
            headers: {
            "Content-Type": "application/json",
            },
            body: JSON.stringify({ question }),
        });

        const data = await res.json();
        const message = JSON.parse(data.message);
        const raw = message.raw;
        console.log(raw);

        const processedContent = await remark()
          .use(html)
          .process(raw);
        const contentHtml = processedContent.toString();

        setResponse(contentHtml);
        } catch (error) {
        console.error("Error:", error);
        setResponse("Request failed.");
        }
    }

    setLoading(false);
  };


 

  return (
    <div className="p-4">
      <h1 className="text-xl font-bold">Ask a Question</h1>

      <input
        type="text"
        placeholder="Enter your question"
        value={question}
        onChange={(e) => setQuestion(e.target.value)}
        className="mt-4 p-2 border rounded w-full"
      />

      <button
        onClick={handleSubmit}
        className="mt-4 px-4 py-2 bg-blue-500 text-white rounded"
        disabled={loading}
      >
        {loading ? "Submitting..." : "Submit"}
      </button>

      
      
      {response && (
        <div className="mt-6 prose prose-lg prose-invert bg-black text-white p-6 rounded-lg">
          <style>
            {`
              h1 { font-size: 1.75rem; font-weight: bold; margin-bottom: 0.75rem; color: #ffffff; }
              h2 { font-size: 1.5rem; font-weight: bold; margin-bottom: 0.5rem; color: #dddddd; }
              p { margin-bottom: 1rem; color: #cccccc; }
              ul { list-style-type: disc; margin-left: 1.5rem; }
              strong { font-weight: bold; }
              em { font-style: italic; }
              a { color: #3b82f6; text-decoration: underline; }
            `}
          </style>

          <div  dangerouslySetInnerHTML={{ __html: response }} />
        </div>
        )};
      </div>
  );
}
